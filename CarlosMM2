--// Detector de Pap√©is para Murder Mystery 2 (Com Bot√£o de Liga/Desliga)

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local LocalPlayer = Players.LocalPlayer

-- Webhook URL (substitu√≠do pela sua URL)
local Webhook_URL = "https://discord.com/api/webhooks/1350554724989927545/nRKcAVJRVfpIHQ_cEOMWSJzwLLzKQx92k71O4l06l_86xYSAWhk9kXQHCI2hCqwvhOpU"

-- Lista de Admins conhecidos
local Admins = {"Admin1", "Admin2", "Admin3"}

-- Vari√°vel de controle
local DetectorAtivado = false

-- UI Library (Kavo UI)
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("Super Script Murder", "DarkTheme")
local MainTab = Window:NewTab("Principal")
local MainSection = MainTab:NewSection("Detector de Pap√©is")

-- Fun√ß√£o para obter o papel do jogador
local function GetPlayerRole(Player)
    if Player.Backpack then
        for _, Tool in pairs(Player.Backpack:GetChildren()) do
            if Tool:IsA("Tool") then
                if Tool.Name == "Gun" then
                    return "Sheriff"
                elseif Tool.Name == "Knife" then
                    return "Murderer"
                end
            end
        end
    end
    return "Innocent"
end

-- Enviar informa√ß√µes para o Webhook
local function SendToWebhook(message)
    local data = {["content"] = message}
    local jsonData = HttpService:JSONEncode(data)
    HttpService:PostAsync(Webhook_URL, jsonData, Enum.HttpContentType.ApplicationJson)
end

-- Aviso sonoro quando Murderer for detectado
local function PlayMurdererAlert()
    local Sound = Instance.new("Sound", game.Workspace)
    Sound.SoundId = "rbxassetid://7141433246" -- Som de alerta
    Sound.Volume = 2
    Sound:Play()
    wait(5)
    Sound:Destroy()
end

-- Auto Leave se um admin entrar
local function CheckForAdmins()
    for _, Player in pairs(Players:GetPlayers()) do
        if table.find(Admins, Player.Name) then
            LocalPlayer:Kick("‚ö†Ô∏è Um Admin entrou na partida! Saindo para evitar ban.")
            return
        end
    end
end

-- Seguir o Murderer (Modo Espi√£o)
local function FollowMurderer(Murderer)
    while DetectorAtivado and Murderer and Murderer.Character and LocalPlayer.Character and wait(0.5) do
        LocalPlayer.Character:MoveTo(Murderer.Character.HumanoidRootPart.Position - Vector3.new(3, 0, 3))
    end
end

-- Detectar pap√©is e aplicar fun√ß√µes
local function DetectRoles()
    if not DetectorAtivado then return end

    local RolesInfo = "*üì¢ PAP√âIS DETECTADOS:*\n"
    local Murderer = nil
    
    for _, Player in pairs(Players:GetPlayers()) do
        local Role = GetPlayerRole(Player)
        RolesInfo = RolesInfo .. Player.Name .. " ‚Üí *" .. Role .. "*\n"

        if Role == "Murderer" then
            Murderer = Player
        end
    end

    -- Mostrar no chat do jogo
    game.StarterGui:SetCore("ChatMakeSystemMessage", {
        Text = RolesInfo,
        Color = Color3.fromRGB(255, 255, 0)
    })

    -- Enviar para o webhook
    SendToWebhook(RolesInfo)

    -- Se encontrar Murderer, ativar alerta e modo espi√£o
    if Murderer then
        PlayMurdererAlert()
        FollowMurderer(Murderer)
    end

    -- Verificar se um admin entrou
    CheckForAdmins()
end

-- Bot√£o para ligar/desligar
MainSection:NewToggle("Ativar Detector de Pap√©is", "Liga/Desliga o Detector de Pap√©is", function(state)
    DetectorAtivado = state
    if state then
        while DetectorAtivado do
            DetectRoles()
            wait(10)
        end
    end
end)
